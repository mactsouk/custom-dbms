version: v1.0
name: Install different versions MySQL + PostgreSQL
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: MySQL
    task:
      jobs:
      - name: Install MySQL 5.7.23
        commands:
          - checkout
          - mysql --version
          - sudo apt-get remove -y --purge mysql-client
          - sudo apt-get remove -y --purge mysql-server
          - sudo apt-get remove -y --purge mysql-common
          - sudo apt -y autoremove
          - wget https://downloads.mysql.com/archives/get/file/mysql-server_5.7.23-1ubuntu18.04_amd64.deb-bundle.tar
          - mkdir mysql
          - cd mysql
          - tar xvf ../mysql-server_5.7.23-1ubuntu18.04_amd64.deb-bundle.tar
          - yes | sudo apt install libaio1 libmecab2
          - sudo dpkg -i *.deb
          - mysqld --version
          - mysql --version

  - name: PostgreSQL
    task:
      jobs:
      - name: Install PostgreSQL
        commands:
          - checkout
          - echo "make smoke"

